function Create{
$currentDirectory = Split-Path -Parent $MyInvocation.MyCommand.Definition
$exePath = Join-Path -Path $currentDirectory -ChildPath "DemoService.exe"

if (Test-Path $exePath) {
    $installUtilPath = Join-Path -Path $env:windir -ChildPath "Microsoft.NET\Framework\v4.0.30319\InstallUtil.exe"

    if (Test-Path $installUtilPath) {
        Start-Process -FilePath $installUtilPath -ArgumentList $exePath -NoNewWindow -Wait
    } else {
        Write-Host "InstallUtil.exe not found!"
    }
} else {
    Write-Host "DemoService.exe not found!"
    }
}

function Edit{
    $serviceName = "Auto"

    if(-not (Get-Service -Name $serviceName)){
        Write-Host "$serviceName not existed"
        return
    }
    try{
        $valueName = Read-Host "Input value name"
        $valueData = Read-Host "Input value data"
        $serviceKeyPath = "HKLM:\SYSTEM\CurrentControlSet\Services\$serviceName\"
        if(-not (Test-Path $serviceKeyPath)){
            New-Item -Path $serviceKeyPath -Force | Out-Null
        }

        Set-ItemProperty -Path $serviceKeyPath -Name $valueName -Value $valueData

        Write-Host "Successfully"
    } catch {
        Write-Host "Error"
    }
    Set-Service -serviceName $serviceName
}

function Delete{
$serviceName = "Auto"

$serviceExists = (Get-Service -Name $serviceName -ErrorAction SilentlyContinue) -ne $null
if ($serviceExists) {

    Stop-Service -Name $serviceName -Force

    sc.exe delete $serviceName
    sc delete $serviceName

} else {
    Write-Host "$serviceName not existed."
    }
}

While ($true) {
    $Answer = Read-Host "Do you want to create, edit or delete the service? 1. Create [1] 
2.Edit [2] 3.Delete [3] 4.Exit [4]`nPress"

    if ($Answer -eq "1") {
        Create
        }

    elseif ($Answer -eq "2") {
        Edit
        }

    elseif ($Answer -eq "3") {
        Delete
        }

    elseif($Answer -eq "4"){
        break
        }
    else {
        Write-Host "Try again!"
    }
}
