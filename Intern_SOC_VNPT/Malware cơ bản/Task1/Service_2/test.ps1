function Create{
$serviceName = "AutoCal"
$binaryPath = "C:\Windows\System32\calc.exe"
$description = "Tự động mở Calculator khi khởi động máy."

if(Get-Service -Name $serviceName -ErrorAction SilentlyContinue){
    Write-Host "Service Existed"
} else {
    $service = New-Service -Name $serviceName -BinaryPathName $binaryPath -Description $description -StartupType Automatic 

    if($service){
        Write-Host "Sucessfully"
    } else {
        Write-Host "Error"
        }
    }
}

function Edit{
    $serviceName = "AutoCal"

    if(-not (Get-Service -Name $serviceName)){
        Write-Host "$serviceName not existed"
        return
    }
    try{
        $serviceKeyPath = "HKLM:\SYSTEM\CurrentControlSet\Services\$serviceName\"
        Get-Item -Path $serviceKeyPath
        $valueName = Read-Host "Input value name"
        $valueData = Read-Host "Input value data"

        if(-not (Test-Path $serviceKeyPath)){
            New-Item -Path $serviceKeyPath -Force | Out-Null
        }

        Set-ItemProperty -Path $serviceKeyPath -Name $valueName -Value $valueData

        Write-Host "Successfully"
    } catch {
        Write-Host "Error"
    }
    Set-Service -serviceName $serviceName
}

function Delete{
$serviceName = "AutoCal"

$serviceExists = (Get-Service -Name $serviceName -ErrorAction SilentlyContinue) -ne $null
if ($serviceExists) {

    sc.exe delete $serviceName
    sc delete $serviceName

} else {
    Write-Host "$serviceName not existed."
    }
}

While ($true) {
    $Answer = Read-Host "Do you want to create, edit or delete the service? 1. Create [1] 
2.Edit [2] 3.Delete [3] 4.Exit [4]`nPress"

    if ($Answer -eq "1") {
        Create
        }

    elseif ($Answer -eq "2") {
        Edit
        }

    elseif ($Answer -eq "3") {
        Delete
        }

    elseif($Answer -eq "4"){
        break
        }
    else {
        Write-Host "Try again!"
    }
}
