function Create{
$taskName = 'AutoCal'
$curentDate = Get-Date
#$taskTrigger = New-ScheduledTaskTrigger -AtStartup 
$taskTrigger = New-ScheduledTaskTrigger -Once -At $curentDate
$taskAction = New-ScheduledTaskAction -Execute "calc.exe" 
$description = "Open Calculator at set up"

$existingTask = Get-ScheduledTask -TaskName $taskName -ErrorAction SilentlyContinue

if (-not $existingTask) {
    Register-ScheduledTask -TaskName $taskName -Description $description -Action $taskAction -Trigger $taskTrigger
    Start-ScheduledTask -TaskName $taskName
    Write-Host "Task '$taskName' has been registered."
} else {
    Write-Host "Task '$taskName' already exists."
    }
}

function Edit{
$taskName = Read-Host 'Task name'
$task = Get-ScheduledTask -TaskName $taskName
if ($task -eq $null) {
    Write-Host "Task '$taskName' does not exist."
} else {
    $newDescription = Read-Host "New description for the task"
    $task.Description = $newDescription
    $task | Set-ScheduledTask
    Write-Host "'$taskName' has been updated."
    }
}

function Delete{
$taskName = 'AutoCal'
Unregister-ScheduledTask -TaskName $taskName
}

While ($true) {
    $Answer = Read-Host "Do you want to create, edit or delete the task schedule? 1. Create [1] 
2.Edit [2] 3.Delete [3] 4.Exit [4]`nPress"

    if ($Answer -eq "1") {
        Create
        }

    elseif ($Answer -eq "2") {
        Edit
        }

    elseif ($Answer -eq "3") {
        Delete
        }

    elseif($Answer -eq "4"){
        break
        }
    else {
        Write-Host "Try again!"
    }
}
